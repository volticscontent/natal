<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #34495e; }
      .text { font-family: Arial, sans-serif; font-size: 12px; fill: #2c3e50; }
      .small-text { font-family: Arial, sans-serif; font-size: 10px; fill: #7f8c8d; }
      .step-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; rx: 8; }
      .process-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; rx: 8; }
      .decision-box { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .data-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; rx: 8; }
      .external-box { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; rx: 8; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .data-flow { stroke: #27ae60; stroke-width: 2; fill: none; marker-end: url(#arrowhead); stroke-dasharray: 5,5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" class="title">Sistema de Personalização - Recadinhos do Papai Noel</text>
  <text x="600" y="55" text-anchor="middle" class="subtitle">Fluxo de Comportamento Ideal</text>
  
  <!-- Step 1: Quantidade de Crianças -->
  <rect x="50" y="100" width="180" height="80" class="step-box"/>
  <text x="140" y="125" text-anchor="middle" class="subtitle" fill="white">Step 1</text>
  <text x="140" y="145" text-anchor="middle" class="text" fill="white">Quantidade de</text>
  <text x="140" y="160" text-anchor="middle" class="text" fill="white">Crianças (1-3)</text>
  
  <!-- Step 2: Order Bumps -->
  <rect x="280" y="100" width="180" height="80" class="step-box"/>
  <text x="370" y="125" text-anchor="middle" class="subtitle" fill="white">Step 2</text>
  <text x="370" y="145" text-anchor="middle" class="text" fill="white">Order Bumps</text>
  <text x="370" y="160" text-anchor="middle" class="text" fill="white">Seleção</text>
  
  <!-- Step 3: Dados das Crianças -->
  <rect x="510" y="100" width="180" height="80" class="step-box"/>
  <text x="600" y="125" text-anchor="middle" class="subtitle" fill="white">Step 3</text>
  <text x="600" y="145" text-anchor="middle" class="text" fill="white">Dados das Crianças</text>
  <text x="600" y="160" text-anchor="middle" class="text" fill="white">+ Contato</text>
  
  <!-- Data Storage -->
  <rect x="750" y="100" width="150" height="80" class="data-box"/>
  <text x="825" y="125" text-anchor="middle" class="subtitle" fill="white">LocalStorage</text>
  <text x="825" y="145" text-anchor="middle" class="text" fill="white">Dados</text>
  <text x="825" y="160" text-anchor="middle" class="text" fill="white">Persistidos</text>
  
  <!-- Checkout Decision -->
  <polygon points="600,220 650,250 600,280 550,250" class="decision-box"/>
  <text x="600" y="255" text-anchor="middle" class="text" fill="white">Checkout?</text>
  
  <!-- URL Generation -->
  <rect x="400" y="320" width="180" height="80" class="process-box"/>
  <text x="490" y="345" text-anchor="middle" class="subtitle" fill="white">URL Generator</text>
  <text x="490" y="365" text-anchor="middle" class="text" fill="white">useCheckoutUrl</text>
  <text x="490" y="380" text-anchor="middle" class="text" fill="white">Generator</text>
  
  <!-- LastLink Mapper -->
  <rect x="620" y="320" width="180" height="80" class="process-box"/>
  <text x="710" y="345" text-anchor="middle" class="subtitle" fill="white">LastLink Mapper</text>
  <text x="710" y="365" text-anchor="middle" class="text" fill="white">useLastLinkUrl</text>
  <text x="710" y="380" text-anchor="middle" class="text" fill="white">Mapper</text>
  
  <!-- Provider Selection -->
  <polygon points="490,440 540,470 490,500 440,470" class="decision-box"/>
  <text x="490" y="475" text-anchor="middle" class="text" fill="white">Provider?</text>
  
  <!-- LastLink Checkout -->
  <rect x="300" y="540" width="150" height="80" class="external-box"/>
  <text x="375" y="565" text-anchor="middle" class="subtitle" fill="white">LastLink</text>
  <text x="375" y="585" text-anchor="middle" class="text" fill="white">Checkout BR</text>
  <text x="375" y="600" text-anchor="middle" class="small-text" fill="white">BRL, CPF</text>
  
  <!-- CartPanda Checkout -->
  <rect x="500" y="540" width="150" height="80" class="external-box"/>
  <text x="575" y="565" text-anchor="middle" class="subtitle" fill="white">CartPanda</text>
  <text x="575" y="585" text-anchor="middle" class="text" fill="white">Checkout Intl</text>
  <text x="575" y="600" text-anchor="middle" class="small-text" fill="white">USD, Global</text>
  
  <!-- Data Types -->
  <rect x="50" y="220" width="200" height="120" class="data-box"/>
  <text x="150" y="240" text-anchor="middle" class="subtitle" fill="white">Tipos de Dados</text>
  <text x="60" y="260" class="small-text" fill="white">• Crianca: nome, foto?, idade?, comportamento?</text>
  <text x="60" y="275" class="small-text" fill="white">• PersData: children[], mensagem, order_bumps[]</text>
  <text x="60" y="290" class="small-text" fill="white">• ContactData: nome, email, telefone, cnpj?</text>
  <text x="60" y="305" class="small-text" fill="white">• OrderBumpSelection: 4k, fast, photo, combo</text>
  <text x="60" y="320" class="small-text" fill="white">• SessionData: session_id, user_data</text>
  
  <!-- Order Bumps Details -->
  <rect x="950" y="100" width="200" height="120" class="data-box"/>
  <text x="1050" y="120" text-anchor="middle" class="subtitle" fill="white">Order Bumps</text>
  <text x="960" y="140" class="small-text" fill="white">• 4k-quality: Qualidade 4K</text>
  <text x="960" y="155" class="small-text" fill="white">• fast-delivery: Entrega Rápida</text>
  <text x="960" y="170" class="small-text" fill="white">• child-photo: Foto da Criança</text>
  <text x="960" y="185" class="small-text" fill="white">• combo-addons: Combo Completo</text>
  <text x="960" y="205" class="small-text" fill="white">Máximo: 4 seleções simultâneas</text>
  
  <!-- URL Mapping Logic -->
  <rect x="750" y="440" width="200" height="120" class="data-box"/>
  <text x="850" y="460" text-anchor="middle" class="subtitle" fill="white">Lógica de URLs</text>
  <text x="760" y="480" class="small-text" fill="white">• Combo → withCombo</text>
  <text x="760" y="495" class="small-text" fill="white">• 4K + Fast + Photo → withAll</text>
  <text x="760" y="510" class="small-text" fill="white">• 4K + Fast → with4KAndFastDelivery</text>
  <text x="760" y="525" class="small-text" fill="white">• 4K + Photo → with4KAndPhoto</text>
  <text x="760" y="540" class="small-text" fill="white">• Fast + Photo → withFastDeliveryAndPhoto</text>
  <text x="760" y="555" class="small-text" fill="white">• Individual → with4K, withFastDelivery, etc.</text>
  
  <!-- Validation -->
  <rect x="700" y="540" width="150" height="80" class="process-box"/>
  <text x="775" y="565" text-anchor="middle" class="subtitle" fill="white">Validação</text>
  <text x="775" y="585" text-anchor="middle" class="text" fill="white">Dados + URLs</text>
  <text x="775" y="600" text-anchor="middle" class="small-text" fill="white">Pré-checkout</text>
  
  <!-- Arrows -->
  <line x1="230" y1="140" x2="280" y2="140" class="arrow"/>
  <line x1="460" y1="140" x2="510" y2="140" class="arrow"/>
  <line x1="690" y1="140" x2="750" y2="140" class="arrow"/>
  <line x1="600" y1="180" x2="600" y2="220" class="arrow"/>
  <line x1="600" y1="280" x2="490" y2="320" class="arrow"/>
  <line x1="580" y1="360" x2="620" y2="360" class="arrow"/>
  <line x1="490" y1="400" x2="490" y2="440" class="arrow"/>
  <line x1="440" y1="470" x2="375" y2="540" class="arrow"/>
  <line x1="540" y1="470" x2="575" y2="540" class="arrow"/>
  <line x1="650" y1="580" x2="700" y2="580" class="arrow"/>
  
  <!-- Data flows -->
  <line x1="825" y1="180" x2="825" y2="360" class="data-flow"/>
  <line x1="825" y1="360" x2="800" y2="360" class="data-flow"/>
  <line x1="850" y1="440" x2="710" y2="400" class="data-flow"/>
  
  <!-- Labels -->
  <text x="255" y="135" class="small-text">Próximo</text>
  <text x="485" y="135" class="small-text">Próximo</text>
  <text x="715" y="135" class="small-text">Salvar</text>
  <text x="605" y="205" class="small-text">Finalizar</text>
  <text x="420" y="505" class="small-text">BR</text>
  <text x="520" y="505" class="small-text">Intl</text>
  <text x="830" y="270" class="small-text">Dados</text>
  <text x="830" y="285" class="small-text">Persistidos</text>
  
  <!-- Footer -->
  <text x="600" y="780" text-anchor="middle" class="small-text">
    Sistema desenvolvido com Next.js + TypeScript | Hooks: useCheckoutUrlGenerator + useLastLinkUrlMapper
  </text>
</svg>